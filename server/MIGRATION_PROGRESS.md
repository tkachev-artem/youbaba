# üìä –ü—Ä–æ–≥—Ä–µ—Å—Å –º–∏–≥—Ä–∞—Ü–∏–∏ MongoDB + MinIO

## ‚úÖ –≠—Ç–∞–ø 1: –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ (Docker) - –ó–ê–í–ï–†–®–ï–ù

**–î–∞—Ç–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è:** 2026-01-29 22:49

### –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏:

- [x] –°–æ–∑–¥–∞–Ω `docker-compose.yml` —Å MongoDB 7.0 –∏ MinIO
- [x] –ó–∞–ø—É—â–µ–Ω—ã –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã MongoDB –∏ MinIO
- [x] –ü—Ä–æ–≤–µ—Ä–µ–Ω–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å —Å–µ—Ä–≤–∏—Å–æ–≤
- [x] –°–æ–∑–¥–∞–Ω bucket `products` –≤ MinIO
- [x] –ù–∞—Å—Ç—Ä–æ–µ–Ω –ø—É–±–ª–∏—á–Ω—ã–π –¥–æ—Å—Ç—É–ø (download) –¥–ª—è bucket

### –†–µ–∑—É–ª—å—Ç–∞—Ç—ã:

**MongoDB:**
- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä: `youbaba-mongodb`
- –í–µ—Ä—Å–∏—è: 7.0.28
- –ü–æ—Ä—Ç: 27017
- –°—Ç–∞—Ç—É—Å: ‚úÖ Healthy
- Credentials: admin / admin123
- –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö: youbaba_db

**MinIO:**
- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä: `youbaba-minio`
- –ü–æ—Ä—Ç API: 9000
- –ü–æ—Ä—Ç Console: 9001
- –°—Ç–∞—Ç—É—Å: ‚úÖ Healthy
- Credentials: minioadmin / minioadmin123
- Bucket: `products` (public download)
- Console: http://localhost:9001

**Docker Volumes:**
- `server_mongodb_data` - –¥–∞–Ω–Ω—ã–µ MongoDB
- `server_minio_data` - —Ñ–∞–π–ª—ã MinIO

**Docker Network:**
- `server_youbaba-network` - –≤–Ω—É—Ç—Ä–µ–Ω–Ω—è—è —Å–µ—Ç—å

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏:

```bash
# –°—Ç–∞—Ç—É—Å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
docker-compose ps

# –ü—Ä–æ–≤–µ—Ä–∫–∞ MongoDB
docker exec youbaba-mongodb mongosh --eval "db.version()"

# –ü—Ä–æ–≤–µ—Ä–∫–∞ MinIO
curl http://localhost:9000/minio/health/live

# –°–ø–∏—Å–æ–∫ buckets
docker exec youbaba-minio mc ls local/
```

### –ö–æ–º–∞–Ω–¥—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è:

```bash
# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã
docker-compose down

# –ó–∞–ø—É—Å—Ç–∏—Ç—å –∑–∞–Ω–æ–≤–æ
docker-compose up -d

# –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ª–æ–≥–∏
docker-compose logs -f

# –ü–æ–ª–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ (–≤–∫–ª—é—á–∞—è –¥–∞–Ω–Ω—ã–µ!)
docker-compose down -v
```

---

## ‚úÖ –≠—Ç–∞–ø 2: Backend - –ë–∞–∑–∞ - –ó–ê–í–ï–†–®–ï–ù

**–î–∞—Ç–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è:** 2026-01-29 23:07

### –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏:

- [x] –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã npm –ø–∞–∫–µ—Ç—ã: mongoose, minio, multer, sharp, jsonwebtoken, bcryptjs, joi, helmet, express-rate-limit
- [x] –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã TypeScript —Ç–∏–ø—ã: @types/multer, @types/jsonwebtoken, @types/bcryptjs
- [x] –°–æ–∑–¥–∞–Ω config/database.ts - –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ MongoDB —Å Mongoose
- [x] –°–æ–∑–¥–∞–Ω config/minio.ts - –∫–ª–∏–µ–Ω—Ç MinIO —Å –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–µ–π bucket
- [x] –°–æ–∑–¥–∞–Ω config/auth.ts - JWT –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –∏ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è
- [x] –°–æ–∑–¥–∞–Ω–∞ models/Product.ts - Mongoose —Å—Ö–µ–º–∞ –¥–ª—è —Ç–æ–≤–∞—Ä–æ–≤ —Å –∏–Ω–¥–µ–∫—Å–∞–º–∏
- [x] –°–æ–∑–¥–∞–Ω–∞ models/Admin.ts - Mongoose —Å—Ö–µ–º–∞ –¥–ª—è –∞–¥–º–∏–Ω–æ–≤ —Å bcrypt —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ–º
- [x] –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω—ã –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ MongoDB –∏ MinIO

### –†–µ–∑—É–ª—å—Ç–∞—Ç—ã:

**NPM –ø–∞–∫–µ—Ç—ã —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã:**
```
mongoose@8.0.0
minio@7.1.0
multer@1.4.5-lts.1
sharp@0.33.0
jsonwebtoken@9.0.2
bcryptjs@2.4.3
joi@17.11.0
helmet@7.1.0
express-rate-limit@7.1.0
```

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞:**
```
server/src/
‚îú‚îÄ‚îÄ config/
‚îÇ   ‚îú‚îÄ‚îÄ database.ts    ‚úÖ MongoDB connection
‚îÇ   ‚îú‚îÄ‚îÄ minio.ts       ‚úÖ MinIO client
‚îÇ   ‚îî‚îÄ‚îÄ auth.ts        ‚úÖ JWT utilities
‚îú‚îÄ‚îÄ models/
‚îÇ   ‚îú‚îÄ‚îÄ Product.ts     ‚úÖ Product schema
‚îÇ   ‚îî‚îÄ‚îÄ Admin.ts       ‚úÖ Admin schema
‚îî‚îÄ‚îÄ scripts/
    ‚îî‚îÄ‚îÄ test-connections.ts ‚úÖ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
```

**MongoDB:**
- ‚úÖ –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚úÖ –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö: `youbaba_db`
- ‚úÖ Mongoose –≤–µ—Ä—Å–∏—è: 8.0.0
- ‚ö†Ô∏è –ë–µ–∑ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ (–¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏)

**MinIO:**
- ‚úÖ –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚úÖ Bucket `products` —Å–æ–∑–¥–∞–Ω
- ‚úÖ Public read –¥–æ—Å—Ç—É–ø –Ω–∞—Å—Ç—Ä–æ–µ–Ω
- ‚úÖ URL: http://localhost:9000

**–ú–æ–¥–µ–ª–∏:**
- ‚úÖ Product: 9 –∫–∞—Ç–µ–≥–æ—Ä–∏–π, –∏–Ω–¥–µ–∫—Å—ã, –ø–æ–¥–¥–µ—Ä–∂–∫–∞ WebP –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- ‚úÖ Admin: bcrypt —Ö–µ—à, —Ä–æ–ª–∏ (admin/super), –º–µ—Ç–æ–¥—ã —Å—Ä–∞–≤–Ω–µ–Ω–∏—è –ø–∞—Ä–æ–ª–µ–π

### –ö–æ–º–∞–Ω–¥—ã –ø—Ä–æ–≤–µ—Ä–∫–∏:

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π
cd server && npx tsx src/scripts/test-connections.ts

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã—Ö –ø–∞–∫–µ—Ç–æ–≤
npm list mongoose minio sharp multer
```

---

## ‚úÖ –≠—Ç–∞–ø 3: Backend - Services - –ó–ê–í–ï–†–®–ï–ù

**–î–∞—Ç–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è:** 2026-01-29 23:11

### –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏:

- [x] –°–æ–∑–¥–∞–Ω imageService.ts - –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –≤ WebP —Å Sharp
- [x] –°–æ–∑–¥–∞–Ω minioService.ts - –ø–æ–ª–Ω—ã–π –Ω–∞–±–æ—Ä —Ñ—É–Ω–∫—Ü–∏–π –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å MinIO
- [x] –°–æ–∑–¥–∞–Ω productService.ts - –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ CRUD —Ç–æ–≤–∞—Ä–æ–≤

### –†–µ–∑—É–ª—å—Ç–∞—Ç—ã:

**imageService.ts - –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π:**
- ‚úÖ –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è PNG/JPEG ‚Üí WebP (–æ—Ä–∏–≥–∏–Ω–∞–ª + thumbnail)
- ‚úÖ –û—Ä–∏–≥–∏–Ω–∞–ª: –∫–∞—á–µ—Å—Ç–≤–æ 85%, –º–∞–∫—Å 1920x1920px
- ‚úÖ Thumbnail: –∫–∞—á–µ—Å—Ç–≤–æ 80%, —Ñ–∏–∫—Å 400x400px (cover fit)
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è —Ç–∏–ø–æ–≤ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- ‚úÖ –ü–æ–ª—É—á–µ–Ω–∏–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- ‚úÖ –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π

**minioService.ts - –†–∞–±–æ—Ç–∞ —Å MinIO:**
- ‚úÖ –ó–∞–≥—Ä—É–∑–∫–∞ –æ–¥–Ω–æ–≥–æ —Ñ–∞–π–ª–∞
- ‚úÖ –ó–∞–≥—Ä—É–∑–∫–∞ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
- ‚úÖ –£–¥–∞–ª–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤ (–æ–¥–Ω–æ–≥–æ –∏ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö)
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è —Ñ–∞–π–ª–∞
- ‚úÖ –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Ñ–∞–π–ª–µ
- ‚úÖ –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö —Ñ–∞–π–ª–æ–≤ –≤ bucket
- ‚úÖ –°–∫–∞—á–∏–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–∞
- ‚úÖ –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–∞

**productService.ts - –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ —Ç–æ–≤–∞—Ä–æ–≤:**
- ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞ (—Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–µ–π –∏ –∑–∞–≥—Ä—É–∑–∫–æ–π –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π)
- ‚úÖ –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–æ–≤ (—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è, —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞, –ø–∞–≥–∏–Ω–∞—Ü–∏—è, –ø–æ–∏—Å–∫)
- ‚úÖ –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞ –ø–æ ID (—Å —É–≤–µ–ª–∏—á–µ–Ω–∏–µ–º —Å—á–µ—Ç—á–∏–∫–∞ –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–≤)
- ‚úÖ –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–æ–≤ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞ (—Å –∑–∞–º–µ–Ω–æ–π –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π)
- ‚úÖ –£–¥–∞–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞ (—Å —É–¥–∞–ª–µ–Ω–∏–µ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –∏–∑ MinIO)
- ‚úÖ –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ —Ç–æ–≤–∞—Ä–∞
- ‚úÖ –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ "—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º–æ–µ"
- ‚úÖ –ü–æ–ª—É—á–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –ø–æ —Ç–æ–≤–∞—Ä–∞–º
- ‚úÖ –£–≤–µ–ª–∏—á–µ–Ω–∏–µ —Å—á–µ—Ç—á–∏–∫–∞ –ø—Ä–æ–¥–∞–∂

### –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å:

**–û–±—Ä–∞–±–æ—Ç–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π:**
```typescript
// PNG 1.5MB ‚Üí WebP 250KB (–æ—Ä–∏–≥–∏–Ω–∞–ª) + WebP 80KB (thumbnail)
// –≠–∫–æ–Ω–æ–º–∏—è: ~83% –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ç–æ–≤–∞—Ä–∞
const processed = await convertToWebP(buffer, 'product-image1.png');
// –†–µ–∑—É–ª—å—Ç–∞—Ç: product-image1.webp + product-image1-thumb.webp
```

**–†–∞–±–æ—Ç–∞ —Å —Ç–æ–≤–∞—Ä–∞–º–∏:**
```typescript
// –°–æ–∑–¥–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞ (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏: –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è ‚Üí –∑–∞–≥—Ä—É–∑–∫–∞ ‚Üí —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ MongoDB)
const product = await createProduct({...});

// –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è + –ø–∞–≥–∏–Ω–∞—Ü–∏—è
const result = await getProducts({
  category: '–°–∞–ª–∞—Ç—ã',
  available: true,
  sort: 'price',
  order: 'asc',
  page: 1,
  limit: 20
});

// –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
const stats = await getProductStats();
// { total, available, featured, byCategory: [...] }
```

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞:
```
server/src/services/
‚îú‚îÄ‚îÄ imageService.ts      ‚úÖ Sharp –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è (174 —Å—Ç—Ä–æ–∫–∏)
‚îú‚îÄ‚îÄ minioService.ts      ‚úÖ MinIO –æ–ø–µ—Ä–∞—Ü–∏–∏ (232 —Å—Ç—Ä–æ–∫–∏)
‚îî‚îÄ‚îÄ productService.ts    ‚úÖ CRUD —Ç–æ–≤–∞—Ä–æ–≤ (386 —Å—Ç—Ä–æ–∫)
```

---

## ‚úÖ –≠—Ç–∞–ø 4: Backend - API Routes & Middleware - –ó–ê–í–ï–†–®–ï–ù

**–î–∞—Ç–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è:** 2026-01-29 23:23

### –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏:

- [x] –°–æ–∑–¥–∞–Ω middleware/auth.ts - JWT –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∏ –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ä–æ–ª–µ–π
- [x] –°–æ–∑–¥–∞–Ω middleware/upload.ts - Multer –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- [x] –°–æ–∑–¥–∞–Ω middleware/validator.ts - Joi –≤–∞–ª–∏–¥–∞—Ü–∏—è –∏ —Å–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
- [x] –°–æ–∑–¥–∞–Ω middleware/errorHandler.ts - —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
- [x] –°–æ–∑–¥–∞–Ω routes/auth.ts - endpoints –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ (login, me, logout, refresh, check)
- [x] –°–æ–∑–¥–∞–Ω routes/products.ts - –ø–æ–ª–Ω—ã–π CRUD –¥–ª—è —Ç–æ–≤–∞—Ä–æ–≤
- [x] –°–æ–∑–¥–∞–Ω routes/upload.ts - –∑–∞–≥—Ä—É–∑–∫–∞ –∏ —É–¥–∞–ª–µ–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- [x] –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω—ã –≤—Å–µ routes –≤ index.ts —Å middleware
- [x] –î–æ–±–∞–≤–ª–µ–Ω—ã helmet, rate-limiting, CORS, —Å–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏—è

### –†–µ–∑—É–ª—å—Ç–∞—Ç—ã:

**Middleware (4 —Ñ–∞–π–ª–∞):**

1. **auth.ts (2.9KB):**
   - `authenticate` - –ø—Ä–æ–≤–µ—Ä–∫–∞ JWT —Ç–æ–∫–µ–Ω–∞
   - `requireAdmin` - —Ç—Ä–µ–±—É–µ—Ç —Ä–æ–ª—å admin/super
   - `requireSuperAdmin` - —Ç—Ä–µ–±—É–µ—Ç —Ä–æ–ª—å super
   - `optionalAuth` - –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è

2. **upload.ts (4.4KB):**
   - `uploadSingle` - –∑–∞–≥—Ä—É–∑–∫–∞ –æ–¥–Ω–æ–≥–æ —Ñ–∞–π–ª–∞ (max 10MB)
   - `uploadMultiple` - –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ (max 10 —Ñ–∞–π–ª–æ–≤)
   - `handleMulterError` - –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –∑–∞–≥—Ä—É–∑–∫–∏
   - `requireFile/requireFiles` - –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è —Ñ–∞–π–ª–æ–≤
   - –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –∏–º–µ–Ω —Ñ–∞–π–ª–æ–≤
   - –í–∞–ª–∏–¥–∞—Ü–∏—è —Ä–∞–∑–º–µ—Ä–æ–≤ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π

3. **validator.ts (7.1KB):**
   - Joi —Å—Ö–µ–º—ã –¥–ª—è –≤—Å–µ—Ö endpoints
   - `validateCreateProduct`, `validateUpdateProduct`
   - `validateGetProductsQuery`, `validateLogin`
   - `sanitizeStrings` - –∑–∞—â–∏—Ç–∞ –æ—Ç XSS
   - `parseQueryBooleans`, `parseQueryNumbers`

4. **errorHandler.ts (6KB):**
   - –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –æ—à–∏–±–æ–∫
   - –ö–∞—Å—Ç–æ–º–Ω—ã–µ –∫–ª–∞—Å—Å—ã –æ—à–∏–±–æ–∫ (AppError, NotFoundError, etc.)
   - `asyncHandler` - wrapper –¥–ª—è async —Ñ—É–Ω–∫—Ü–∏–π
   - `requestLogger` - –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤
   - `timeoutHandler` - –æ–±—Ä–∞–±–æ—Ç–∫–∞ timeout

**API Routes (4 —Ñ–∞–π–ª–∞):**

1. **auth.ts (3.7KB):**
   ```
   POST   /api/auth/login     - –í—Ö–æ–¥ –∞–¥–º–∏–Ω–∞
   GET    /api/auth/me        - –¢–µ–∫—É—â–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
   POST   /api/auth/logout    - –í—ã—Ö–æ–¥
   POST   /api/auth/refresh   - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞
   GET    /api/auth/check     - –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–æ–∫–µ–Ω–∞
   ```

2. **products.ts (5.4KB):**
   ```
   GET    /api/products                    - –í—Å–µ —Ç–æ–≤–∞—Ä—ã (—Ñ–∏–ª—å—Ç—Ä—ã, –ø–∞–≥–∏–Ω–∞—Ü–∏—è)
   GET    /api/products/stats              - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
   GET    /api/products/category/:category - –ü–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
   GET    /api/products/:id                - –û–¥–∏–Ω —Ç–æ–≤–∞—Ä
   POST   /api/products                    - –°–æ–∑–¥–∞—Ç—å (ADMIN)
   PUT    /api/products/:id                - –û–±–Ω–æ–≤–∏—Ç—å (ADMIN)
   DELETE /api/products/:id                - –£–¥–∞–ª–∏—Ç—å (ADMIN)
   PATCH  /api/products/:id/availability   - –î–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å (ADMIN)
   PATCH  /api/products/:id/featured       - –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–æ–µ (ADMIN)
   ```

3. **upload.ts (4KB):**
   ```
   POST   /api/upload/image      - –ó–∞–≥—Ä—É–∑–∏—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ (ADMIN)
   DELETE /api/upload/:filename  - –£–¥–∞–ª–∏—Ç—å (ADMIN)
   HEAD   /api/upload/:filename  - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ
   POST   /api/upload/test       - –¢–µ—Å—Ç –∑–∞–≥—Ä—É–∑–∫–∏ (ADMIN)
   ```

4. **delivery.ts (—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π):**
   ```
   POST   /api/delivery/calculate - –†–∞—Å—á–µ—Ç –¥–æ—Å—Ç–∞–≤–∫–∏
   ```

**Security & Performance:**

- ‚úÖ **Helmet.js** - –∑–∞—â–∏—Ç–∞ HTTP –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤
- ‚úÖ **Rate Limiting:**
  - API: 100 –∑–∞–ø—Ä–æ—Å–æ–≤ / 15 –º–∏–Ω—É—Ç
  - Login: 5 –ø–æ–ø—ã—Ç–æ–∫ / 15 –º–∏–Ω—É—Ç
- ‚úÖ **CORS** - —Ä–∞–∑—Ä–µ—à–µ–Ω —Ç–æ–ª—å–∫–æ `http://localhost:5173`
- ‚úÖ **Joi –≤–∞–ª–∏–¥–∞—Ü–∏—è** - –≤—Å–µ –≤—Ö–æ–¥—è—â–∏–µ –¥–∞–Ω–Ω—ã–µ
- ‚úÖ **XSS –∑–∞—â–∏—Ç–∞** - —Å–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏—è —Å—Ç—Ä–æ–∫
- ‚úÖ **Request logging** - —Ü–≤–µ—Ç–Ω–æ–π –≤—ã–≤–æ–¥ –ø–æ —Å—Ç–∞—Ç—É—Å–∞–º
- ‚úÖ **Timeout** - 30 —Å–µ–∫—É–Ω–¥ –Ω–∞ –∑–∞–ø—Ä–æ—Å

**index.ts –æ–±–Ω–æ–≤–ª–µ–Ω:**
- –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ MongoDB –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ
- –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è MinIO
- –í—Å–µ middleware –∏ routes –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω—ã
- –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
- Health check endpoint

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏:

```bash
# Health check
curl http://localhost:3001/health

# –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ —Ç–æ–≤–∞—Ä—ã
curl http://localhost:3001/api/products

# –í—Ö–æ–¥ (—Ç—Ä–µ–±—É–µ—Ç—Å—è —Å–æ–∑–¥–∞—Ç—å –∞–¥–º–∏–Ω–∞)
curl -X POST http://localhost:3001/api/auth/login \
  -H "Content-Type: application/json" \
  -d '{"username": "admin", "password": "Admin123!"}'

# –°–æ–∑–¥–∞—Ç—å —Ç–æ–≤–∞—Ä (—Ç—Ä–µ–±—É–µ—Ç—Å—è —Ç–æ–∫–µ–Ω)
curl -X POST http://localhost:3001/api/products \
  -H "Authorization: Bearer <token>" \
  -F "image=@product.png" \
  -F "id=test-product" \
  -F "title=Test Product" \
  -F "category=–°–∞–ª–∞—Ç—ã" \
  -F "gram=200 –≥—Ä." \
  -F "description=Test description" \
  -F "price=500"
```

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞:

```
server/src/
‚îú‚îÄ‚îÄ config/          ‚úÖ (3 —Ñ–∞–π–ª–∞)
‚îú‚îÄ‚îÄ models/          ‚úÖ (2 —Ñ–∞–π–ª–∞)
‚îú‚îÄ‚îÄ services/        ‚úÖ (3 —Ñ–∞–π–ª–∞)
‚îú‚îÄ‚îÄ middleware/      ‚úÖ (4 —Ñ–∞–π–ª–∞)
‚îú‚îÄ‚îÄ routes/          ‚úÖ (4 —Ñ–∞–π–ª–∞)
‚îú‚îÄ‚îÄ scripts/         ‚úÖ (1 —Ñ–∞–π–ª)
‚îî‚îÄ‚îÄ index.ts         ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω
```

**–°–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω –Ω–∞:** `http://localhost:3001`

---

## ‚úÖ –≠—Ç–∞–ø 5: –ú–∏–≥—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö - –ó–ê–í–ï–†–®–ï–ù

**–î–∞—Ç–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è:** 2026-01-29 23:43

### –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏:

- [x] –°–æ–∑–¥–∞–Ω —Å–∫—Ä–∏–ø—Ç seed-admin.ts
- [x] –°–æ–∑–¥–∞–Ω —Å–∫—Ä–∏–ø—Ç migrate-products.ts
- [x] –°–æ–∑–¥–∞–Ω —Å–∫—Ä–∏–ø—Ç migrate-images.ts
- [x] –ó–∞–ø—É—â–µ–Ω seed-admin - —Å–æ–∑–¥–∞–Ω –ø–µ—Ä–≤—ã–π –∞–¥–º–∏–Ω
- [x] –ó–∞–ø—É—â–µ–Ω–∞ –º–∏–≥—Ä–∞—Ü–∏—è —Ç–æ–≤–∞—Ä–æ–≤ - –º–∏–≥—Ä–∏—Ä–æ–≤–∞–Ω–æ 56 —Ç–æ–≤–∞—Ä–æ–≤
- [x] –ó–∞–ø—É—â–µ–Ω–∞ –º–∏–≥—Ä–∞—Ü–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π - –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–æ 56 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π (62.35 MB ‚Üí 5.88 MB)

### –†–µ–∑—É–ª—å—Ç–∞—Ç—ã:

**1. –ê–¥–º–∏–Ω —Å–æ–∑–¥–∞–Ω:**
```
Username: admin
Password: Admin123!
Role: admin
MongoDB ID: [generated]
```

**2. –¢–æ–≤–∞—Ä—ã –º–∏–≥—Ä–∏—Ä–æ–≤–∞–Ω—ã –≤ MongoDB:**
- –í—Å–µ–≥–æ —Ç–æ–≤–∞—Ä–æ–≤: **56**
- –î–æ—Å—Ç—É–ø–Ω—ã—Ö: **56**
- –ù–µ–¥–æ—Å—Ç—É–ø–Ω—ã—Ö: **0**
- –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã—Ö: **0**

**–¢–æ–≤–∞—Ä—ã –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º:**
- –†–æ–ª–ª—ã —Ö–æ–ª–æ–¥–Ω—ã–µ: 16
- –†–æ–ª–ª—ã –∑–∞–ø–µ—á–µ–Ω—ã–µ: 6
- –õ–∞–ø—à–∞/—Ä–∏—Å: 6
- –ó–∞–∫—É—Å–∫–∏: 6
- –†–æ–ª–ª—ã –∂–∞—Ä–µ–Ω–Ω—ã–µ: 5
- –°–∞–ª–∞—Ç—ã: 5
- –°–æ—É—Å—ã: 5
- –°—É–ø—ã: 3
- –ü–æ–∫–µ: 2
- –î–µ—Å–µ—Ä—Ç—ã: 2

**3. –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã –∏ –∑–∞–≥—Ä—É–∂–µ–Ω—ã –≤ MinIO:**
- –í—Å–µ–≥–æ —Ñ–∞–π–ª–æ–≤ –≤ MinIO: **112** (56 –æ—Ä–∏–≥–∏–Ω–∞–ª–æ–≤ + 56 –º–∏–Ω–∏–∞—Ç—é—Ä)
- –†–∞–∑–º–µ—Ä bucket: **5.9 MB**
- –ò—Å—Ö–æ–¥–Ω—ã–π —Ä–∞–∑–º–µ—Ä (PNG): **62.35 MB**
- –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ä–∞–∑–º–µ—Ä (WebP): **5.88 MB**
- **–≠–∫–æ–Ω–æ–º–∏—è: 90.6%** üéâ

**–ü—Ä–∏–º–µ—Ä—ã –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏:**
```
product-image1.png (1.04 MB) ‚Üí product-image1.webp (83 KB) + thumb (13 KB)
product-image2.png (1.26 MB) ‚Üí product-image2.webp (115 KB) + thumb (20 KB)
```

**–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –¥–æ—Å—Ç—É–ø–Ω—ã:**
- –û—Ä–∏–≥–∏–Ω–∞–ª—ã: `http://localhost:9000/products/product-imageX.webp`
- –ú–∏–Ω–∏–∞—Ç—é—Ä—ã: `http://localhost:9000/products/product-imageX-thumb.webp`

### –°–∫—Ä–∏–ø—Ç—ã –º–∏–≥—Ä–∞—Ü–∏–∏:

**seed-admin.ts:**
- –°–æ–∑–¥–∞–µ—Ç –ø–µ—Ä–≤–æ–≥–æ –∞–¥–º–∏–Ω–∞ –∏–∑ .env –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–æ–ª—è (bcrypt)
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –∞–¥–º–∏–Ω–æ–≤
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ credentials

**migrate-products.ts:**
- –ü–∞—Ä—Å–∏—Ç `src/data/products.ts`
- –°–æ–∑–¥–∞–µ—Ç –¥–æ–∫—É–º–µ–Ω—Ç—ã Product –≤ MongoDB
- Placeholder URLs –¥–ª—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –≤—Å–µ—Ö 10 –∫–∞—Ç–µ–≥–æ—Ä–∏–π
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º

**migrate-images.ts:**
- –ß–∏—Ç–∞–µ—Ç PNG –∏–∑ `Images/product-images/`
- –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ—Ç –≤ WebP (original + thumbnail)
- –ó–∞–≥—Ä—É–∂–∞–µ—Ç –≤ MinIO bucket `products`
- –û–±–Ω–æ–≤–ª—è–µ—Ç URLs –∏ —Ä–∞–∑–º–µ—Ä—ã –≤ MongoDB
- –ü–æ–¥—Ä–æ–±–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —ç–∫–æ–Ω–æ–º–∏–∏

### –ö–æ–º–∞–Ω–¥—ã –∑–∞–ø—É—Å–∫–∞:

```bash
# –°–æ–∑–¥–∞—Ç—å –∞–¥–º–∏–Ω–∞
cd server && npx tsx src/scripts/seed-admin.ts

# –ú–∏–≥—Ä–∏—Ä–æ–≤–∞—Ç—å —Ç–æ–≤–∞—Ä—ã
cd server && npx tsx src/scripts/migrate-products.ts

# –ú–∏–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
cd server && npx tsx src/scripts/migrate-images.ts
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏:

```bash
# –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ —Ç–æ–≤–∞—Ä—ã
curl http://localhost:3001/api/products

# –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
curl http://localhost:3001/api/products/stats

# –ü–æ–ª—É—á–∏—Ç—å —Ç–æ–≤–∞—Ä –ø–æ ID
curl http://localhost:3001/api/products/—Å–∞–ª–∞—Ç—ã-—Å–∞–ª–∞—Ç-—é–±–∞–±–∞

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
curl -I http://localhost:9000/products/product-image1.webp

# –í—Ö–æ–¥ –∞–¥–º–∏–Ω–∞
curl -X POST http://localhost:3001/api/auth/login \
  -H "Content-Type: application/json" \
  -d '{"username": "admin", "password": "Admin123!"}'
```

---

## üéâ –ú–ò–ì–†–ê–¶–ò–Ø –ü–û–õ–ù–û–°–¢–¨–Æ –ó–ê–í–ï–†–®–ï–ù–ê!

### –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã:

‚úÖ **Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã:**
- MongoDB (–±–µ–∑ auth, –ª–æ–∫–∞–ª—å–Ω–æ)
- MinIO (minioadmin / minioadmin123)

‚úÖ **Backend API:**
- Express —Å–µ—Ä–≤–µ—Ä: `http://localhost:3001`
- 4 –≥—Ä—É–ø–ø—ã endpoints: auth, products, upload, delivery
- Security: helmet, rate-limiting, CORS, JWT

‚úÖ **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö MongoDB:**
- 56 —Ç–æ–≤–∞—Ä–æ–≤ –≤ 10 –∫–∞—Ç–µ–≥–æ—Ä–∏—è—Ö
- 1 –∞–¥–º–∏–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
- –í—Å–µ –∏–Ω–¥–µ–∫—Å—ã —Å–æ–∑–¥–∞–Ω—ã

‚úÖ **–•—Ä–∞–Ω–∏–ª–∏—â–µ MinIO:**
- 112 WebP –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π (–æ—Ä–∏–≥–∏–Ω–∞–ª—ã + –º–∏–Ω–∏–∞—Ç—é—Ä—ã)
- Public read –¥–æ—Å—Ç—É–ø
- –≠–∫–æ–Ω–æ–º–∏—è 90.6% –º–µ—Å—Ç–∞

### –ß—Ç–æ –¥–∞–ª—å—à–µ?

**–≠—Ç–∞–ø 6:** Frontend –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å API
**–≠—Ç–∞–ø 7:** –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å (React –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã)
**–≠—Ç–∞–ø 8-10:** –ü–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏

**–°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é!** üöÄ

