# YouBaBa Delivery Server

Backend —Å–µ—Ä–≤–µ—Ä –¥–ª—è —Ä–∞—Å—á—ë—Ç–∞ –¥–æ—Å—Ç–∞–≤–∫–∏ –∏ –≥–µ–æ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è –∞–¥—Ä–µ—Å–æ–≤ —á–µ—Ä–µ–∑ Yandex Maps API.

## üöÄ –£—Å—Ç–∞–Ω–æ–≤–∫–∞

```bash
npm install
```

## ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞

1. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ `.env.example` –≤ `.env`:
```bash
cp .env.example .env
```

2. –ü–æ–ª—É—á–∏—Ç–µ API –∫–ª—é—á –Ø–Ω–¥–µ–∫—Å.–ö–∞—Ä—Ç:
   - –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ https://developer.tech.yandex.ru/keys/
   - –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π –∫–ª—é—á –¥–ª—è JavaScript API –∏ HTTP Geocoder
   - –í—Å—Ç–∞–≤—å—Ç–µ –∫–ª—é—á –≤ `.env` —Ñ–∞–π–ª

3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã —Ä–µ—Å—Ç–æ—Ä–∞–Ω–∞ –≤ `.env` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: –†–æ—Å—Ç–æ–≤-–Ω–∞-–î–æ–Ω—É, –≠—Å—Ç–æ–Ω—Å–∫–∞—è 49–ê)

## üèÉ –ó–∞–ø—É—Å–∫

### –†–µ–∂–∏–º —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ (—Å hot-reload):
```bash
npm run dev
```

### Production:
```bash
npm run build
npm start
```

–°–µ—Ä–≤–µ—Ä –∑–∞–ø—É—Å—Ç–∏—Ç—Å—è –Ω–∞ `http://localhost:3001`

## üì° API Endpoints

### 1. –†–∞—Å—á—ë—Ç –¥–æ—Å—Ç–∞–≤–∫–∏
**POST** `/api/delivery/calculate`

Request body:
```json
{
  "address": "–û—Ä–±–∏—Ç–∞–ª—å–Ω–∞—è 15"
}
```

Response:
```json
{
  "address": "–û—Ä–±–∏—Ç–∞–ª—å–Ω–∞—è 15",
  "coordinates": {
    "lat": 47.225970,
    "lng": 39.686114
  },
  "distance": 5.2,
  "cost": 230,
  "isFree": false
}
```

### 2. –ü–æ–¥—Å–∫–∞–∑–∫–∏ –∞–¥—Ä–µ—Å–æ–≤
**GET** `/api/delivery/suggestions?q=–û—Ä–±–∏—Ç`

Response:
```json
[
  {
    "displayName": "–†–æ—Å—Å–∏—è, –†–æ—Å—Ç–æ–≤-–Ω–∞-–î–æ–Ω—É, –û—Ä–±–∏—Ç–∞–ª—å–Ω–∞—è —É–ª–∏—Ü–∞, 15",
    "address": "–û—Ä–±–∏—Ç–∞–ª—å–Ω–∞—è, 15",
    "coordinates": {
      "lat": 47.225970,
      "lng": 39.686114
    }
  }
]
```

### 3. –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã —Ä–µ—Å—Ç–æ—Ä–∞–Ω–∞
**GET** `/api/delivery/restaurant`

Response:
```json
{
  "lat": 47.225970,
  "lng": 39.686114
}
```

## üí∞ –†–∞—Å—á—ë—Ç —Å—Ç–æ–∏–º–æ—Å—Ç–∏ –¥–æ—Å—Ç–∞–≤–∫–∏

- **–ë–µ—Å–ø–ª–∞—Ç–Ω–∞—è –¥–æ—Å—Ç–∞–≤–∫–∞**: –≤ —Ä–∞–¥–∏—É—Å–µ 2 –∫–º –æ—Ç —Ä–µ—Å—Ç–æ—Ä–∞–Ω–∞
- **–ë–∞–∑–æ–≤–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å**: 100 ‚ÇΩ
- **–¶–µ–Ω–∞ –∑–∞ –∫–º**: 25 ‚ÇΩ
- **–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å**: 500 ‚ÇΩ

–§–æ—Ä–º—É–ª–∞: `–°—Ç–æ–∏–º–æ—Å—Ç—å = 100 + (—Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ √ó 25)`, –Ω–æ –Ω–µ –±–æ–ª–µ–µ 500 ‚ÇΩ

## üîß –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

- **Express** - –≤–µ–±-—Ñ—Ä–µ–π–º–≤–æ—Ä–∫
- **TypeScript** - —Ç–∏–ø–∏–∑–∞—Ü–∏—è
- **Yandex Maps Geocoder API** - –≥–µ–æ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ –∞–¥—Ä–µ—Å–æ–≤
- **Axios** - HTTP –∫–ª–∏–µ–Ω—Ç
- **CORS** - –ø–æ–¥–¥–µ—Ä–∂–∫–∞ cross-origin –∑–∞–ø—Ä–æ—Å–æ–≤

## üìù –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
server/
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ index.ts              # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞
‚îÇ   ‚îú‚îÄ‚îÄ routes/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ delivery.ts       # API —Ä–æ—É—Ç—ã
‚îÇ   ‚îî‚îÄ‚îÄ services/
‚îÇ       ‚îî‚îÄ‚îÄ geocoder.ts       # –°–µ—Ä–≤–∏—Å –≥–µ–æ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è
‚îú‚îÄ‚îÄ .env                      # –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
‚îú‚îÄ‚îÄ package.json
‚îú‚îÄ‚îÄ tsconfig.json
‚îî‚îÄ‚îÄ README.md
```

## üêõ –û—Ç–ª–∞–¥–∫–∞

–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –≤ –∫–æ–Ω—Å–æ–ª–∏:
```
üöÄ –°–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω –Ω–∞ –ø–æ—Ä—Ç—É 3001
üìç –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã —Ä–µ—Å—Ç–æ—Ä–∞–Ω–∞: 47.22597, 39.686114
üó∫Ô∏è  Yandex Maps API: ‚úì –Ω–∞—Å—Ç—Ä–æ–µ–Ω
```

–ï—Å–ª–∏ API –∫–ª—é—á –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω, –≤—ã —É–≤–∏–¥–∏—Ç–µ:
```
üó∫Ô∏è  Yandex Maps API: ‚úó –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω
```
